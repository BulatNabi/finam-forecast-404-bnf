
# FORECAST

## Описание проекта
Этот скрипт реализует модель прогнозирования движения цен на основе данных свечей с использованием XGBoost. Модель обучается на 20 горизонтах и поддерживает два режима: `train` (обучение и сохранение моделей) и `predict` (генерация предсказаний). Веса моделей сохраняются в ZIP-архиве с использованием `joblib`.

## Требования
- **Операционная система**: Linux, Windows или macOS.
- **Python**: Версия 3.7 или выше.
- **Библиотеки**:
  - `pandas`
  - `numpy`
  - `xgboost`
  - `scikit-learn`
  - `joblib`
  - `tqdm`
  - `zipfile` (входит в стандартную библиотеку Python)
- **GPU**: Опционально, но рекомендуется NVIDIA GPU с поддержкой CUDA для ускорения обучения (проверьте с помощью `nvidia-smi`).

### Установка зависимостей
1. Убедитесь, что у вас установлен Python. Проверьте версию командой:
   ```bash
   python3 --version
   ```
2. Установите необходимые библиотеки с помощью `pip`:
   ```bash
   pip install pandas numpy xgboost scikit-learn joblib tqdm
   ```
3. (Опционально) Для GPU-поддержки установите CUDA и cuDNN, соответствующие вашей версии XGBoost.

### Данные
- Скрипт использует данные из файлов:
  - `candles.csv`
  - `candles_2.csv`
- Убедитесь, что эти файлы доступны в директории скрипта или обновите пути в коде.

### Запуск скрипта
Скрипт запускается в двух режимах: `train` и `predict`. Переключение выполняется изменением переменной `mode` в коде.

#### 1. Режим обучения (`mode = 'train'`)
- **Цель**: Обучить модели, сохранить их веса в `models.zip`.
- **Шаги**:
  1. Откройте файл скрипта (например, `script.py`) в текстовом редакторе.
  2. Найдите строку:
     ```python
     mode = 'train'  # Установите 'train' или 'predict'
     ```
     Убедитесь, что значение `'train'` установлено.
  3. Сохраните файл.
  4. Запустите скрипт в терминале:
     ```bash
     python3 script.py
     ```
- **Что произойдет**:
  - Модели для 20 горизонтов будут обучены с использованием GPU (если доступно).
  - Веса моделей сохранятся в архиве `models.zip`.
- **Ожидаемый результат**: Файл `models.zip` появится в директории.

#### 2. Режим предсказания (`mode = 'predict'`)
- **Цель**: Загрузить обученные модели и сгенерировать предсказания.
- **Шаги**:
  1. Убедитесь, что файл `models.zip` существует (сгенерирован в `train` режиме).
  2. Откройте файл скрипта и измените строку на:
     ```python
     mode = 'predict'  # Установите 'train' или 'predict'
     ```
  3. Сохраните файл.
  4. Запустите скрипт:
     ```bash
     python3 script.py
     ```
- **Что произойдет**:
  - Модели извлекутся из `models.zip` и загружены.
  - Предсказания для тестовых данных (после 2025-09-08) будут сгенерированы.
  - Результаты сохранятся в файлах `predictions_all.csv` (все дни) и `predictions_workdays.csv` (только рабочие дни).
- **Ожидаемый результат**: Файлы предсказаний появятся в директории.

### Объяснение работы
- **Данные**: Скрипт загружает свечи из двух CSV-файлов, объединяет их и делит на тренировочные (до 2025-09-08) и тестовые (начиная с 2025-09-08).
- **Признаки**: Создаются технические индикаторы (lag_close, MA, RSI, MACD и др.) для анализа цен.
- **Модель**: XGBoost обучается на 20 горизонтах с параметрами: 500 итераций, learning_rate=0.03, max_depth=15 и др.
- **Сохранение**: Веса моделей сохраняются в `models.zip` с помощью `joblib` для компактности.

